<!DOCTYPE html>
<html>
<head>
  <title>Oracles</title>
  <style>
    body {
      font-family: 'Georgia', serif;
      max-width: 700px;
      margin: 0 auto;
      padding: 20px;
      background: #f8f5f0;
      color: #333;
      line-height: 1.6;
    }
    h1 {
      text-align: center;
      color: #5a3921;
      border-bottom: 1px solid #d4c9b8;
      padding-bottom: 10px;
    }
    .controls {
      background: #fff9ee;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    .source-option {
      margin: 10px 0;
      padding: 8px 12px;
      background: #f0e6d2;
      border-radius: 4px;
      display: flex;
      align-items: center;
    }
    button {
      display: block;
      width: 100%;
      padding: 12px;
      background: #8b7355;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s;
      margin-top: 20px;
    }
    button:hover {
      background: #6b5a45;
    }
    #output {
      min-height: 120px;
      padding: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      font-size: 18px;
      border-left: 4px solid #8b7355;
    }
    .source-name {
      font-weight: bold;
      margin-left: 8px;
      color: #5a3921;
    }
  </style>
</head>
<body>
  <h1>Poetry Mixer</h1>
  
  <div class="controls">
    <h3>Select Sources:</h3>
    <label class="source-option">
      <input type="checkbox" class="source-toggle" data-source="dreamlandfill" checked>
      <span class="source-name">Dreamlandfill</span>
    </label>
    <label class="source-option">
      <input type="checkbox" class="source-toggle" data-source="orchard" checked>
      <span class="source-name">Orchard</span>
    </label>
    <label class="source-option">
      <input type="checkbox" class="source-toggle" data-source="song" checked>
      <span class="source-name">Song</span>
    </label>
    
    <button id="generateBtn">Generate Random Line</button>
  </div>
  
  <div id="output">Select sources and click the button above</div>

  <script>
    // Configuration - matches your file names exactly
    const SOURCES = {
      dreamlandfill: 'dreamlandfill.txt',
      orchard: 'orchard.txt',
      song: 'song.txt'
    };

    // Store loaded lines
    const loadedLines = {
      dreamlandfill: [],
      orchard: [],
      song: []
    };

    // Track active sources (start with all enabled)
    let activeSources = new Set(Object.keys(SOURCES));

    // DOM Elements
    const sourceToggles = document.querySelectorAll('.source-toggle');
    const generateBtn = document.getElementById('generateBtn');
    const outputEl = document.getElementById('output');

    // Load all text files
    async function loadAllSources() {
      try {
        outputEl.textContent = "Loading poems...";
        
        const loadPromises = Object.entries(SOURCES).map(async ([sourceName, fileName]) => {
          const response = await fetch(fileName);
          if (!response.ok) throw new Error(`Failed to load ${fileName}`);
          const text = await response.text();
          loadedLines[sourceName] = text.split('\n')
            .map(line => line.trim())
            .filter(line => line.length > 0);
        });

        await Promise.all(loadPromises);
        outputEl.textContent = "Ready! Select sources and click the button.";
        
      } catch (error) {
        console.error('Error loading poems:', error);
        outputEl.textContent = `Error loading poems: ${error.message}`;
      }
    }

    // Generate random line from active sources
    function generateRandomLine() {
      // Combine lines from active sources
      const allLines = [];
      activeSources.forEach(source => {
        allLines.push(...loadedLines[source]);
      });

      if (allLines.length === 0) {
        outputEl.textContent = 'Please select at least one source!';
        return;
      }

      const randomIndex = Math.floor(Math.random() * allLines.length);
      const randomLine = allLines[randomIndex];
      
      // Display with source attribution
      const sourceName = Object.keys(SOURCES).find(key => 
        loadedLines[key].includes(randomLine)
      );
      outputEl.innerHTML = `"${randomLine}"<br><small>â€” from ${sourceName}</small>`;
    }

    // Event Listeners
    sourceToggles.forEach(toggle => {
      toggle.addEventListener('change', (e) => {
        const source = e.target.dataset.source;
        if (e.target.checked) {
          activeSources.add(source);
        } else {
          activeSources.delete(source);
        }
      });
    });

    generateBtn.addEventListener('click', generateRandomLine);

    // Initialize
    loadAllSources();
  </script>
</body>
</html>